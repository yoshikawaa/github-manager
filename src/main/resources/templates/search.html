<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<title>Pulls</title>
<meta charset="utf-8">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/siimple@3.0.0/dist/siimple.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>
<body>
    <div class="siimple-content--fluid">
        <div class="siimple-breadcrumb">
            <a class="siimple-breadcrumb-crumb" th:href="@{/}">Home</a>
            <a class="siimple-breadcrumb-crumb" href="#">Pulls</a>
        </div>

        <div class="siimple-h1">Search Issues</div>

        <form class="siimple-form siimple-grid" th:action th:object="${searchQuery}">
            <div class="siimple-grid-row">
                <div class="siimple-grid-col siimple-grid-col--8">
                    <label class="siimple-label">Query:</label>
                    <input type="text" class="siimple-input siimple-input--fluid" th:field="*{q}"
                        placeholder="is:open is:pr">
                </div>
                <div class="siimple-grid-col siimple-grid-col--2">
                    <label class="siimple-label">Sort:</label> <select class="siimple-select siimple-select--fluid"
                        name="sort">
                        <option th:each="sort : ${@sorts}" th:text="${sort}" th:selected="${sort} == *{sort}"></option>
                    </select>
                </div>
                <div class="siimple-grid-col siimple-grid-col--2">
                    <label class="siimple-label">Order:</label> <select class="siimple-select siimple-select--fluid"
                        name="order">
                        <option th:each="order : ${@orders}" th:text="${order}" th:selected="${order} == *{order}"></option>
                    </select>
                </div>
            </div>
        </form>

        <div class="siimple-table siimple-table--border siimple-table--striped siimple-table--hover">
            <div class="siimple-table-header">
                <div class="siimple-table-row">
                    <div class="siimple-table-cell">Repository</div>
                    <div class="siimple-table-cell">Title</div>
                    <div class="siimple-table-cell">Body</div>
                    <div class="siimple-table-cell">State</div>
                    <div class="siimple-table-cell">Action</div>
                </div>
            </div>
            <div class="siimple-table-body">
                <div class="siimple-table-row" th:each="issue : ${issues}" th:object="${issue}">
                    <div class="siimple-table-cell">
                        <a class="siimple-link" target="_blank"
                            th:href="|${@environment.getProperty('app.url.github')}/*{owner}/*{repo}|"
                            th:text="|*{owner}/*{repo}|"></a>
                    </div>
                    <div class="siimple-table-cell">
                        <a class="siimple-link" target="_blank" th:href="*{htmlUrl}" th:text="|#*{number} *{title}|"></a>
                    </div>
                    <div class="siimple-table-cell"
                        th:text="*{(not #strings.isEmpty(body)) and (#strings.length(body) gt 100) ?
                                     #strings.substring(body,0,99) + '...' : body}"></div>
                    <div class="siimple-table-cell" th:text="*{state}"></div>
                    <div class="siimple-table-cell">
                        <a th:if="*{pullRequest} ne null" class="siimple-btn siimple-btn--blue"
                            th:href="@{/repos/{owner}/{repo}/pulls/{number}(owner=*{owner},repo=*{repo},number=*{number})}">Details</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $("select").on("change", function() {
            $(this).parents("form").submit();
        });
    </script>
</body>
</html>